<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dare to Ask</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg: #f5f7fb;
      --card: #ffffff;
      --brand: #0b1f44;
      --accent: #3856d5;
      --muted: #64748b;
      --border: #d9e3f8;
      --pill: #eff2ff;
      --shadow: 0 14px 40px rgba(15, 23, 42, 0.15);
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0f172a;
        --card: #111c34;
        --brand: #eef2ff;
        --accent: #6c8bff;
        --muted: #cbd5f5;
        --border: rgba(148, 163, 184, 0.35);
        --pill: rgba(99, 102, 241, 0.2);
        --shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
      }
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: 'Inter', 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--brand);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 48px 24px 24px;
      text-align: center;
    }

    header h1 {
      margin: 0;
      font-size: clamp(2.25rem, 3vw, 3rem);
      letter-spacing: -0.02em;
    }

    header p {
      margin: 14px auto 0;
      max-width: 680px;
      color: var(--muted);
      font-size: clamp(1rem, 2vw, 1.15rem);
      line-height: 1.6;
    }

    main {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 32px;
      padding: 0 24px 80px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .card {
      background: var(--card);
      border-radius: 18px;
      padding: 28px;
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      gap: 22px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 40px rgba(56, 86, 213, 0.18);
    }

    .card h2 {
      margin: 0;
      font-size: 1.25rem;
      letter-spacing: -0.01em;
    }

    form {
      display: grid;
      gap: 18px;
    }

    label {
      display: grid;
      gap: 8px;
      font-weight: 600;
      color: var(--brand);
    }

    input, textarea {
      border-radius: 12px;
      padding: 14px 16px;
      border: 1px solid var(--border);
      font: inherit;
      background: rgba(255, 255, 255, 0.85);
      color: inherit;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    input:focus, textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 4px rgba(56, 86, 213, 0.18);
    }

    textarea {
      resize: vertical;
      min-height: 140px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 14px 20px;
      font-size: 1rem;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      background: linear-gradient(135deg, var(--accent), #111cfe);
      color: #fff;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 24px rgba(17, 28, 254, 0.25);
    }

    button:disabled {
      opacity: 0.65;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .pill {
      display: inline-flex;
      padding: 6px 12px;
      border-radius: 999px;
      background: var(--pill);
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--accent);
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .question-list {
      display: flex;
      flex-direction: column;
      gap: 18px;
      max-height: 80vh;
      overflow-y: auto;
      padding-right: 4px;
    }

    .question {
      padding: 20px;
      border-radius: 16px;
      border: 1px solid var(--border);
      background: rgba(255, 255, 255, 0.7);
      display: grid;
      gap: 14px;
    }

    .question header {
      padding: 0;
      text-align: left;
    }

    .question h3 {
      margin: 0;
      font-size: 1.05rem;
    }

    .question footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .question footer button {
      padding: 8px 14px;
      font-size: 0.9rem;
      border-radius: 999px;
      background: rgba(17, 28, 254, 0.08);
      color: var(--accent);
      box-shadow: none;
      transition: background 0.2s ease, color 0.2s ease;
    }

    .question footer button:hover {
      background: rgba(17, 28, 254, 0.18);
    }

    .question footer button.voted {
      background: var(--accent);
      color: #fff;
    }

    .question .answer {
      border-left: 4px solid var(--accent);
      padding-left: 14px;
      color: var(--brand);
      line-height: 1.55;
    }

    .empty-state {
      text-align: center;
      padding: 32px;
      border: 1px dashed var(--border);
      border-radius: 16px;
      color: var(--muted);
    }

    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }

    .filters input {
      min-width: 200px;
    }

    .radio-group {
      display: inline-flex;
      background: rgba(17, 28, 254, 0.06);
      padding: 4px;
      border-radius: 999px;
      gap: 4px;
    }

    .radio-group label {
      margin: 0;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 999px;
      cursor: pointer;
      color: var(--accent);
      transition: background 0.2s ease, color 0.2s ease;
    }

    .radio-group input {
      display: none;
    }

    .radio-group label.active {
      background: #fff;
      color: var(--accent);
      box-shadow: 0 6px 14px rgba(56, 86, 213, 0.18);
    }

    .meta-line {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      font-size: 0.85rem;
      color: var(--muted);
    }

    @media (max-width: 768px) {
      main {
        padding-bottom: 48px;
      }

      .card {
        padding: 24px;
      }

      .question-list {
        max-height: none;
      }
    }
  </style>
</head>
<body>
  <header>
    <span class="pill">Ask bravely</span>
    <h1>Dare to Ask</h1>
    <p>
      A trusted space for curious minds. Drop an anonymous question for our subject-matter experts, discover what others are
      wondering, and help us prioritise the next answers with an upvote.
    </p>
  </header>

  <main>
    <section class="card" aria-labelledby="ask-title">
      <div>
        <h2 id="ask-title">Ask a question</h2>
        <p style="margin: 8px 0 0; color: var(--muted);">
          No sign-in required. We share questions with SMEs daily and publish answers as soon as they arrive.
        </p>
      </div>
      <form id="askForm">
        <label>
          Question <span style="color:#ef4444">*</span>
          <textarea name="question" placeholder="What would you like to know?" maxlength="400" required></textarea>
        </label>
        <label>
          Context for SMEs
          <textarea name="details" placeholder="Optional background that helps experts provide a thoughtful answer" maxlength="800"></textarea>
        </label>
        <label>
          Topic tag
          <input name="tag" type="text" placeholder="e.g. Compliance, Product, HR" maxlength="40" />
        </label>
        <button type="submit">Submit anonymously</button>
        <p id="formStatus" role="status" style="margin:0;font-size:0.9rem;color:var(--muted);"></p>
      </form>
    </section>

    <section class="card" aria-live="polite">
      <div style="display:flex;flex-direction:column;gap:10px;">
        <div style="display:flex;justify-content:space-between;align-items:center;gap:18px;flex-wrap:wrap;">
          <h2 style="margin:0;">Questions from the community</h2>
          <span id="questionCount" class="pill" aria-live="polite"></span>
        </div>
        <div class="filters">
          <input id="search" type="search" placeholder="Search questions" aria-label="Search questions" />
          <div class="radio-group" role="radiogroup" aria-label="Filter questions">
            <label class="active"><input type="radio" name="filter" value="all" checked /> All</label>
            <label><input type="radio" name="filter" value="unanswered" /> Awaiting answer</label>
            <label><input type="radio" name="filter" value="answered" /> Answered</label>
          </div>
        </div>
      </div>
      <div id="questionList" class="question-list" aria-live="polite"></div>
    </section>
  </main>

  <template id="questionTemplate">
    <article class="question">
      <header>
        <div class="meta-line">
          <span class="pill" data-tag></span>
          <span data-status></span>
          <span data-timestamp></span>
        </div>
        <h3 data-question></h3>
      </header>
      <p data-details style="margin:0;color:var(--muted);"></p>
      <div class="answer" data-answer></div>
      <footer>
        <button type="button" data-upvote>
          <span aria-hidden="true">⬆️</span> Upvote
        </button>
        <span data-count></span>
        <button type="button" data-answer-btn style="margin-left:auto;background:rgba(16,185,129,0.12);color:#047857;">
          Add answer
        </button>
      </footer>
    </article>
  </template>

  <script>
    const form = document.getElementById('askForm');
    const statusEl = document.getElementById('formStatus');
    const listEl = document.getElementById('questionList');
    const template = document.getElementById('questionTemplate');
    const searchInput = document.getElementById('search');
    const radioLabels = document.querySelectorAll('.radio-group label');
    const countEl = document.getElementById('questionCount');

    const STORAGE_KEY = 'dare-to-ask-questions-v1';
    const VOTE_KEY = 'dare-to-ask-votes';

    const sampleQuestions = [
      {
        id: crypto.randomUUID(),
        question: 'How does the new risk assessment framework affect day-to-day decision making?',
        details: 'I have seen the deck, but still unsure how to apply the tiers when signing off initiatives.',
        tag: 'Risk & Compliance',
        createdAt: Date.now() - 1000 * 60 * 60 * 4,
        votes: 12,
        answer: 'Great question! The short version is that every initiative now starts with a self-assessment against the three-tier matrix. If an activity touches customer data or regulatory commitments it automatically escalates to Tier 2 for SME review. We are rolling out a lightweight checklist next Monday to make this easier.',
      },
      {
        id: crypto.randomUUID(),
        question: 'What support is available for managers preparing performance reviews this cycle?',
        details: 'We have several new team leads who are nervous about the new template.',
        tag: 'People',
        createdAt: Date.now() - 1000 * 60 * 60 * 24,
        votes: 7,
        answer: '',
      }
    ];

    const loadQuestions = () => {
      try {
        const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));
        return Array.isArray(saved) ? saved : sampleQuestions;
      } catch (error) {
        console.error('Failed to read storage', error);
        return sampleQuestions;
      }
    };

    const saveQuestions = (items) => {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
    };

    const loadVotes = () => {
      try {
        const saved = JSON.parse(localStorage.getItem(VOTE_KEY));
        return saved && typeof saved === 'object' ? saved : {};
      } catch {
        return {};
      }
    };

    const saveVotes = (votes) => {
      localStorage.setItem(VOTE_KEY, JSON.stringify(votes));
    };

    let questions = loadQuestions();
    let votes = loadVotes();
    let activeFilter = 'all';
    let searchTerm = '';

    const timeAgo = (timestamp) => {
      const delta = Math.max(0, Date.now() - timestamp);
      const minute = 60 * 1000;
      const hour = 60 * minute;
      const day = 24 * hour;
      if (delta < minute) return 'just now';
      if (delta < hour) {
        const mins = Math.round(delta / minute);
        return `${mins} minute${mins === 1 ? '' : 's'} ago`;
      }
      if (delta < day) {
        const hours = Math.round(delta / hour);
        return `${hours} hour${hours === 1 ? '' : 's'} ago`;
      }
      const days = Math.round(delta / day);
      return `${days} day${days === 1 ? '' : 's'} ago`;
    };

    const renderQuestions = () => {
      listEl.innerHTML = '';
      let filtered = questions;

      if (activeFilter === 'unanswered') {
        filtered = filtered.filter(q => !q.answer);
      } else if (activeFilter === 'answered') {
        filtered = filtered.filter(q => !!q.answer);
      }

      if (searchTerm) {
        const query = searchTerm.toLowerCase();
        filtered = filtered.filter(q =>
          q.question.toLowerCase().includes(query) ||
          (q.details && q.details.toLowerCase().includes(query)) ||
          (q.tag && q.tag.toLowerCase().includes(query))
        );
      }

      countEl.textContent = `${filtered.length} question${filtered.length === 1 ? '' : 's'}`;

      if (!filtered.length) {
        listEl.innerHTML = '<div class="empty-state">No questions yet. Be the first to ask something brave!</div>';
        return;
      }

      const frag = document.createDocumentFragment();
      filtered
        .sort((a, b) => b.votes - a.votes || b.createdAt - a.createdAt)
        .forEach(q => {
          const instance = template.content.cloneNode(true);
          const tagEl = instance.querySelector('[data-tag]');
          const statusEl = instance.querySelector('[data-status]');
          const timestampEl = instance.querySelector('[data-timestamp]');
          const qEl = instance.querySelector('[data-question]');
          const detailsEl = instance.querySelector('[data-details]');
          const answerEl = instance.querySelector('[data-answer]');
          const upvoteBtn = instance.querySelector('[data-upvote]');
          const countEl = instance.querySelector('[data-count]');
          const answerBtn = instance.querySelector('[data-answer-btn]');

          tagEl.textContent = q.tag || 'General';
          statusEl.textContent = q.answer ? 'Answered' : 'Awaiting answer';
          timestampEl.textContent = timeAgo(q.createdAt);
          qEl.textContent = q.question;
          detailsEl.textContent = q.details || '';
          detailsEl.style.display = q.details ? 'block' : 'none';
          answerEl.textContent = q.answer;
          answerEl.style.display = q.answer ? 'block' : 'none';
          countEl.textContent = `${q.votes} upvote${q.votes === 1 ? '' : 's'}`;

          if (votes[q.id]) {
            upvoteBtn.classList.add('voted');
            upvoteBtn.textContent = '⬆️ Upvoted';
          }

          upvoteBtn.addEventListener('click', () => {
            if (votes[q.id]) return;
            q.votes += 1;
            votes[q.id] = true;
            saveVotes(votes);
            saveQuestions(questions);
            renderQuestions();
          });

          answerBtn.addEventListener('click', () => {
            const answer = prompt('Add an answer to share with everyone:');
            if (answer && answer.trim()) {
              q.answer = answer.trim();
              saveQuestions(questions);
              renderQuestions();
            }
          });

          frag.appendChild(instance);
        });

      listEl.appendChild(frag);
    };

    form.addEventListener('submit', (event) => {
      event.preventDefault();
      const data = new FormData(form);
      const question = (data.get('question') || '').trim();
      const details = (data.get('details') || '').trim();
      const tag = (data.get('tag') || '').trim();

      if (!question) {
        statusEl.textContent = 'Please enter a question before submitting.';
        return;
      }

      const newQuestion = {
        id: crypto.randomUUID(),
        question,
        details,
        tag,
        createdAt: Date.now(),
        votes: 0,
        answer: '',
      };

      questions.unshift(newQuestion);
      saveQuestions(questions);
      form.reset();
      statusEl.textContent = 'Thanks! Your question has been queued for our SMEs.';
      renderQuestions();
      setTimeout(() => statusEl.textContent = '', 4000);
    });

    searchInput.addEventListener('input', (event) => {
      searchTerm = event.target.value;
      renderQuestions();
    });

    document.querySelectorAll('input[name="filter"]').forEach((input, index) => {
      input.addEventListener('change', () => {
        activeFilter = input.value;
        radioLabels.forEach(label => label.classList.remove('active'));
        radioLabels[index].classList.add('active');
        renderQuestions();
      });
    });

    renderQuestions();
  </script>
</body>
</html>
